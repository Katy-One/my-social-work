{"ast":null,"code":"import _defineProperty from\"C:\\\\Users\\\\Katerina\\\\Desktop\\\\github-social-work\\\\my-social-work\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"C:\\\\Users\\\\Katerina\\\\Desktop\\\\github-social-work\\\\my-social-work\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\Katerina\\\\Desktop\\\\github-social-work\\\\my-social-work\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"C:\\\\Users\\\\Katerina\\\\Desktop\\\\github-social-work\\\\my-social-work\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"C:\\\\Users\\\\Katerina\\\\Desktop\\\\github-social-work\\\\my-social-work\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import{ProfileAPI,UserAPI}from\"../api/api\";import{stopSubmit}from'redux-form';var updateNewTextPost='updateNewTextPost';var addpost='ADD-POST';var SET_USER_PROFILE='SET_USER_PROFILE';var SET_STATUS='SET_STATUS';var SET_PHOTO='SET_PHOTO';var initialState={postInfo:[{id:1,massage:'post1',like:12},{id:2,massage:'post2',like:20},{id:3,massage:'post3',like:1}],profile:null,status:''};var profileReducer=function profileReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case addpost:var newPost={id:action.id,massage:action.text,like:0};return _objectSpread({},state,{postInfo:[].concat(_toConsumableArray(state.postInfo),[newPost])});case updateNewTextPost:return _objectSpread({},state,{newPostText:action.nextText});case SET_USER_PROFILE:return _objectSpread({},state,{profile:action.profile});case SET_STATUS:return _objectSpread({},state,{status:action.status});case SET_PHOTO:return _objectSpread({},state,{profile:_objectSpread({},state.profile,{photos:action.photo})});default:return state;}};export var addPostText=function addPostText(id,text){return{type:addpost,id:id,text:text};};export var setStatusProfile=function setStatusProfile(status){return{type:SET_STATUS,status:status};};export var updateNewPostText=function updateNewPostText(text){return{type:updateNewTextPost,nextText:text};};export var setUsersProfile=function setUsersProfile(profile){return{type:SET_USER_PROFILE,profile:profile};};export var setUsersPhoto=function setUsersPhoto(photo){return{type:SET_PHOTO,photo:photo};};export var setPhotoApi=function setPhotoApi(file){return(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return ProfileAPI.photo(file);case 2:response=_context.sent;if(response.data.resultCode==0){console.log(response.data);dispatch(setUsersPhoto(response.data.data.photos));}case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());};export var getUsersProfile=function getUsersProfile(userId){return(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return UserAPI.getProfile(userId);case 2:response=_context2.sent;dispatch(setUsersProfile(response.data));case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}());};export var getStatus=function getStatus(userId){return(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return ProfileAPI.getStatus(userId);case 2:response=_context3.sent;dispatch(setStatusProfile(response.data));case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}());};export var saveProfile=function saveProfile(profile){return(/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch,getState){var id,response,message,nameContact;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:id=getState().auth.userId;_context4.next=3;return ProfileAPI.saveProfile(profile);case 3:response=_context4.sent;if(!(response.data.resultCode===0)){_context4.next=8;break;}dispatch(getUsersProfile(id));_context4.next=13;break;case 8:console.log(response.data);message=response.data.messages.length>0?response.data.messages[0]:'Some error';nameContact=message.split('->').reverse()[0].slice(0,-1).toLocaleLowerCase();dispatch(stopSubmit('dataForm',{\"contacts\":_defineProperty({},nameContact,message)}));return _context4.abrupt(\"return\",Promise.reject(response.data.messages[0]));case 13:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x4,_x5){return _ref4.apply(this,arguments);};}());};export var updateStatus=function updateStatus(status){return(/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(dispatch){var response;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return ProfileAPI.setStatus(status);case 2:response=_context5.sent;if(response.data.resultCode===0){dispatch(setStatusProfile(status));}case 4:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x6){return _ref5.apply(this,arguments);};}());};export default profileReducer;","map":{"version":3,"sources":["C:/Users/Katerina/Desktop/github-social-work/my-social-work/src/redux/profile-reducer.js"],"names":["ProfileAPI","UserAPI","stopSubmit","updateNewTextPost","addpost","SET_USER_PROFILE","SET_STATUS","SET_PHOTO","initialState","postInfo","id","massage","like","profile","status","profileReducer","state","action","type","newPost","text","newPostText","nextText","photos","photo","addPostText","setStatusProfile","updateNewPostText","setUsersProfile","setUsersPhoto","setPhotoApi","file","dispatch","response","data","resultCode","console","log","getUsersProfile","userId","getProfile","getStatus","saveProfile","getState","auth","message","messages","length","nameContact","split","reverse","slice","toLocaleLowerCase","Promise","reject","updateStatus","setStatus"],"mappings":"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","sourcesContent":["import {ProfileAPI, UserAPI} from \"../api/api\";\r\nimport {stopSubmit} from 'redux-form';\r\n\r\nlet updateNewTextPost = 'updateNewTextPost';\r\nlet addpost = 'ADD-POST';\r\nlet SET_USER_PROFILE = 'SET_USER_PROFILE'\r\nlet SET_STATUS = 'SET_STATUS'\r\nlet SET_PHOTO = 'SET_PHOTO'\r\nlet initialState = {\r\n    postInfo: [\r\n        {\r\n            id: 1,\r\n            massage: 'post1',\r\n            like: 12\r\n        },\r\n        {\r\n            id: 2,\r\n            massage: 'post2',\r\n            like: 20\r\n        },\r\n        {\r\n            id: 3,\r\n            massage: 'post3',\r\n            like: 1\r\n        },\r\n    ],\r\n    profile: null,\r\n    status: '',\r\n\r\n}\r\n\r\nconst profileReducer = (state = initialState, action) => {\r\n\r\n    switch (action.type) {\r\n        case addpost:\r\n\r\n            let newPost = {\r\n                id: action.id,\r\n                massage: action.text,\r\n                like: 0\r\n            };\r\n\r\n\r\n            return {\r\n                ...state,\r\n                postInfo: [...state.postInfo, newPost],\r\n\r\n            }\r\n        case updateNewTextPost:\r\n\r\n            return {\r\n                ...state,\r\n                newPostText: action.nextText\r\n            }\r\n        case SET_USER_PROFILE:\r\n\r\n            return {\r\n                ...state,\r\n                profile: action.profile\r\n            }\r\n        case SET_STATUS:\r\n            return {\r\n                ...state,\r\n                status: action.status\r\n            }\r\n        case SET_PHOTO:\r\n            return {\r\n                ...state,\r\n                profile: {...state.profile, photos: action.photo}\r\n\r\n            }\r\n        default :\r\n            return state\r\n    }\r\n}\r\nexport const addPostText = (id, text) => {\r\n\r\n    return {\r\n        type: addpost,\r\n        id: id,\r\n        text\r\n    }\r\n};\r\nexport const setStatusProfile = (status) => {\r\n\r\n    return {\r\n        type: SET_STATUS,\r\n        status: status\r\n    }\r\n};\r\nexport const updateNewPostText = (text) => {\r\n\r\n    return {\r\n        type: updateNewTextPost,\r\n        nextText: text\r\n    }\r\n};\r\nexport const setUsersProfile = (profile) => ({type: SET_USER_PROFILE, profile});\r\nexport const setUsersPhoto = (photo) => ({type: SET_PHOTO, photo});\r\nexport const setPhotoApi = (file) => {\r\n\r\n    return async (dispatch) => {\r\n\r\n\r\n        let response = await ProfileAPI.photo(file)\r\n\r\n        if (response.data.resultCode == 0) {\r\n            console.log(response.data)\r\n            dispatch(setUsersPhoto(response.data.data.photos))\r\n\r\n\r\n        }\r\n    }\r\n}\r\nexport const getUsersProfile = (userId) => {\r\n\r\n    return async (dispatch) => {\r\n        let response = await UserAPI.getProfile(userId)\r\n\r\n        dispatch(setUsersProfile(response.data))\r\n\r\n    }\r\n}\r\nexport const getStatus = (userId) => {\r\n    return async (dispatch) => {\r\n\r\n        let response = await ProfileAPI.getStatus(userId)\r\n        dispatch(setStatusProfile(response.data))\r\n\r\n    }\r\n}\r\nexport const saveProfile = (profile) => {\r\n    return async (dispatch, getState) => {\r\n        let id = getState().auth.userId\r\n        let response = await ProfileAPI.saveProfile(profile)\r\n\r\n        if (response.data.resultCode === 0) {\r\n            dispatch(getUsersProfile(id))\r\n        }else {\r\n            console.log(response.data)\r\n            let message = response.data.messages.length > 0 ? response.data.messages[0] : 'Some error'\r\n            let nameContact = message.split('->').reverse()[0].slice(0, -1).toLocaleLowerCase()\r\n\r\n             dispatch(stopSubmit('dataForm', {\"contacts\":{[nameContact] :  message} }))\r\n            return Promise.reject(response.data.messages[0])\r\n        }\r\n\r\n\r\n    }\r\n}\r\nexport const updateStatus = (status) => {\r\n\r\n    return async (dispatch) => {\r\n        let response = await ProfileAPI.setStatus(status)\r\n        if (response.data.resultCode === 0) {\r\n            dispatch(setStatusProfile(status))\r\n        }\r\n    }\r\n}\r\nexport default profileReducer"]},"metadata":{},"sourceType":"module"}